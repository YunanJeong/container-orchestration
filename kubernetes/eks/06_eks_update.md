# EKS Update

- EKS 쿠버네티스 버전 릴리즈 주기는 꽤나 짧음
- 평균 4개월에 한 번씩 새로운 Kubernetes 마이너 버전이 출시되며 표준 지원 기간은 1~2년에 불과
- 컨테이너 환경 특성상 업데이트시 문제발생확률이 낮고, 문제가 발생하지 않는게 맞지만 그래도 업그레이드가 걱정될 수 있음
- 몇 가지 주의사항만 알고 있으면 될 듯 함

## 주의사항

- 표준 지원 및 **추가 지원기간이 끝나면 강제 자동 업그레이드**된다.
- 업그레이드시, 콘솔 클러스터 메뉴의 `업그레이드 인사이트` 항목이 모두 Passing 상태여야 한다.
  - 일반적으로 이 항목에서 다음버전과의 호환성 체크를 할 수 있다.
  - 업그레이드 인사이트 항목에서 ERROR 항목이 있을 시 자동업데이트도 되지 않는다.

### 수동설치한 컨트롤플레인 앱 주의!! (AWS Controller, Karpenter 등등)

- AWS EBS Controller
- aws-load-balancer-controller
- Karpenter 등등
- 컨트롤플레인 또는 노드배포 영역에 관여하는 앱들을 Helm 등으로 수동배포한 후, 클러스터를 관리하는 경우가 많은데, 개별 설치된 앱들이므로 EKS 시스템 내에서 컨트롤플레인 영역으로 인식하지 않는다. 업그레이드 인사이트에서 확인불가.
- **수동설치된 컨트롤러 앱들과, 신규버전 Kubernetes의 호환성을 반드시 체크**해야 한다.

### 현재 실행된 노드AMI가 차기버전 kubernetes와 미호환되는 경우

- AWS 노드그룹으로 배포된 노드는 콘솔에서 마우스 클릭 몇번으로 쉽게 업글가능하며, 롤링업데이트 등 간단한 전략적 업데이트 방안이 제공된다.
- 당연히 실행중인 노드가 꺼지므로, 일반적인 쿠버네티스 앱이라면 상관없겠지만
- 항상 켜져있어야 하거나, Stateful한 앱이 있을 수 있으므로 이 부분을 체크하자!
  - 원칙적으로는 이런 앱들은 EBS기반 PV, StatefulSet, 클러스터링 기반 HA 등으로 미리 대비되어 있어야하는게 맞다.
